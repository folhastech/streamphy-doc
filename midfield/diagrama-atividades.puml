@startuml
|Inicio|
start

:Receber Mensagem MQTT;

:Extrair Id Gateway;

:Verificar Gateway;
if (Gateway encontrado?) then (N達o)
  :Registrar Erro;
  stop
else (Sim)
  :Buscar Empresa;
  if (Empresa encontrada?) then (N達o)
    :Registrar Erro;
    stop
  else (Sim)
    :Converter Mensagem;
    if (Erro na convers達o?) then (Sim)
      :Registrar Erro;
      stop
    else (N達o)
      :Verificar Destino da Mensagem;
      if (Webhook configurado?) then (Sim)
        :Enviar Webhook;
        :Registrar Evento;
        stop
      else (MQTT configurado)
        :Enviar MQTT;
        :Registrar Evento;
        stop
      endif
    endif
  endif
endif

@enduml
